--- cyrus-imapd.orig/imap/message.c
+++ cyrus-imapd/imap/message.c
@@ -401,6 +401,8 @@ EXPORTED int message_parse_binary_file(F
 
     message_guid_generate(&(*body)->guid, msg.base, msg.len);
 
+    message_guid_generate(&(*body)->guid, msg.base, msg.len);
+
     lseek(fd, 0L, SEEK_SET);
     n = retry_write(fd, msg.base, msg.len);
 
