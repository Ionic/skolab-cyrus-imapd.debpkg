Description: fix for CVE-2019-19783
 When creating a missing mailbox as part of a sieve 'fileinto' directive,
 lmtpd would create it as administrator, bypassing ACL checks.
 .
 lmtpd creates missing mailboxes as part of a sieve 'fileinto' directive if:
 .
    (2.5+) the anysievefolder option is enabled (default: not), or
    (3.0+) the sieve_extensions option has the 'mailbox' extension enabled
    (default: enabled) and the 'fileinto' directive contains the ":create"
    argument
 .
 Under these conditions, a user with the ability to upload a custom sieve
 script to their account could use it to create any valid mailbox on the
 server (with ACL inherited from the parent mailbox as usual).
 .
 lmtpd no longer creates these mailboxes as administrator, so users may no
 longer use a 'fileinto' directive to create a mailbox they couldnâ€™t create
 otherwise.
Author: Bron Gondwana <brong@fastmailteam.com>
Origin: upstream, https://github.com/cyrusimap/cyrus-imapd/commit/7080d0a
Bug: https://www.cyrusimap.org/imap/download/release-notes/3.0/x/3.0.13.html#security-fixes
Forwarded: not-needed
Reviewed-By: Xavier Guimard <yadd@debian.org>
Last-Update: 2019-12-16

--- a/imap/lmtp_sieve.c
+++ b/imap/lmtp_sieve.c
@@ -999,7 +999,7 @@
     if (createsievefolder) {
         /* Folder is already in internal namespace format */
         r = mboxlist_createmailbox(internalname, 0, NULL,
-                                   1, userid, auth_state, 0, 0, 0, 1, NULL);
+                                   0, userid, auth_state, 0, 0, 0, 1, NULL);
         if (!r) {
             mboxlist_changesub(internalname, userid, auth_state, 1, 1, 1);
             syslog(LOG_DEBUG, "autosievefolder: User %s, folder %s creation succeeded",
