#! /bin/sh /usr/share/dpatch/dpatch-run
## 0025b-cve-2009-3235-extras.dpatch
##
## All lines beginning with `## DP:' are a description of the patch.
## DP: Additions to upstream fix for CVE-2009-3235 = DSA-1893-1 as
## DP: used by Giuseppe Iuculano <giuseppe@iuculano.it> in the Debian
## DP: security update.  Required if %u ever goes 128-bit ;-)
@DPATCH@
Index: cyrus-imapd-2.3-pkg/sieve/bc_eval.c
===================================================================
--- cyrus-imapd-2.3-pkg.orig/sieve/bc_eval.c
+++ cyrus-imapd-2.3-pkg/sieve/bc_eval.c
@@ -635,7 +635,7 @@ static int eval_bc_test(sieve_interp_t *
      
 	if  (match == B_COUNT)
 	{
-	    sprintf(scount, "%u", count);
+	    snprintf(scount, sizeof(scount), "%u", count);
 	    /* search through all the data */ 
 	    currd=datai+2;
 	    for (z=0; z<numdata && !res; z++)
@@ -751,7 +751,7 @@ static int eval_bc_test(sieve_interp_t *
 	
 	if  (match == B_COUNT )
 	{
-	    sprintf(scount, "%u", count);
+	    snprintf(scount, sizeof(scount), "%u", count);
 	    /*search through all the data*/ 
 	    currd=datai+2;
 	    for (z=0; z<numdata && !res; z++)
