From: Debian Cyrus Team <pkg-cyrus-imapd-debian-devel@lists.alioth.debian.org>
Date: Tue, 4 Aug 2015 10:38:07 +0200
Subject: parse-GUID-for-binary-appends-as-well

---
 imap/message.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imap/message.c b/imap/message.c
index 04b312c..2d089a1 100644
--- a/imap/message.c
+++ b/imap/message.c
@@ -401,6 +401,8 @@ EXPORTED int message_parse_binary_file(FILE *infile, struct body **body)
 
     message_guid_generate(&(*body)->guid, msg.base, msg.len);
 
+    message_guid_generate(&(*body)->guid, msg.base, msg.len);
+
     lseek(fd, 0L, SEEK_SET);
     n = retry_write(fd, msg.base, msg.len);
 
